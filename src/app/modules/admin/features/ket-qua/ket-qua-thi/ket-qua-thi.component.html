<div class="w-100 " style="height: calc(100vh - 60px - 30px);">
  <div class="w-100 d-flex justify-content-sm-between" style="padding:10px 0 ; height:60px;">

    <div style="padding:0 10px;">
      <button pButton pRipple [ngClass]="typeTab === 0 ? 'p-button-primary' : 'ovic-button-none-selected'"
              label="Danh sách kết quả thi" icon="pi pi-database" class="h-100 mx-2" style="border-radius: 0;"
              (click)="btnChangeType(0)"
      ></button>
      <button pButton pRipple [ngClass]="typeTab === 1 ? 'p-button-primary' : 'ovic-button-none-selected'"
              label="Import Kết quả thi" icon="pi pi-cloud-upload" class="h-100 mx-2" style="border-radius: 0;"
              (click)="btnChangeType(1)"
      ></button>
    </div>

    <div *ngIf="typeTab=== 1" class="d-flex" style="padding:0 10px;gap:10px">
      <button class="btn_upload_excel" (click)="inputFile()">
        <span class="text_in_line" *ngIf="file_name else notFile">{{ file_name }}</span>
        <ng-template #notFile>
          <i class="fi fa fa-paperclip" aria-hidden="true"> Upload file</i>
        </ng-template>
      </button>

      <p-dropdown class="ketqua_thi" placeholder="Chọn hội đồng thi..." [options]="dsHoidong" optionLabel="ten_hoidong"
                  optionValue="id" (onChange)="changeHoidong($event)"></p-dropdown>
      <button pRipple pButton icon="pi pi-check-circle" label="kiểm tra dữ liệu "
              class="p-button-warning h-100 border-radius-0" [loading]="isLoading"
              (click)="btnKiemtraDulieu()"></button>
      <button pButton pRipple icon="pi pi-save" label="Lưu lại" class="p-button-success h-100 border-radius-0"
              (click)="btnSubmitData()"></button>
      <!--      <button pButton pRipple icon="pi pi-save" label="Ghi đè dữ liệu " class="p-button-success h-100 border-radius-0"></button>-->
      <button pButton pRipple icon="pi pi-times" label="Reset" class="p-button-secondary h-100 border-radius-0"
              (click)="btnReset()"></button>
    </div>
  </div>
  <ng-container [ngSwitch]="typeTab">
    <ng-container *ngSwitchCase="0">
      <div class="w-100 " style="height:calc(100% - 60px);">
        <div class="row h-100">
          <div class="col-12 ovic-ui-table site-thpt" style="height:calc(100%)"
               [class.ovic-is-loading]="isLoading">
            <div class="p-datatable-header" style="height:65px; border-bottom:1px solid #CCC;">
              <h3 class="tbl-title ">Kết quả dự thi</h3>
              <div class="search-block ui-table-globalfilter-container ">
                <div class="d-flex align-items-center">
                  <div class="ovic-vertical__inputs ovic-vertical__inputs--layout-2">
                    <div class="d-flex" style="gap:10px;">
                      <div>
                        <p-dropdown placeholder=" Chọn hội đồng thi... " [options]="dsHoidong" optionLabel="ten_hoidong" [showClear]="true"
                                    optionValue="id" [(ngModel)]="hoidongSiteKetqua_select" (onChange)="selectHoidongBySiteKetqua($event.value)"></p-dropdown>
                      </div>
                      <div>
                        <div class="search-block__elm">
                          <span class="p-input-icon-right">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" placeholder="Tìm kiếm" [(ngModel)]="textSearch"
                                   (input)="onInputChange($event.target['value'])">
                           </span>
                        </div>
                      </div>
                      <div>
                        <button pButton pRipple icon="pi pi-bars" style="height:42px;width: 41px;"
                                [matMenuTriggerFor]="menu"></button>
                        <mat-menu #menu="matMenu" class="d-flex flex-column w-100 h-100 btn-mat-resize">
                          <button class="btn-menu-material delete" (click)="btnDeleteByHoidong()">
                            <i class="pi pi-trash"></i>
                            <span>Xóa kết quả Import</span>
                          </button>
                        </mat-menu>
                      </div>


                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="ovic-wrap-table-rps ovic-scroll-style overflow-hidden overflow-y-auto"
                 style="height:calc(100% - 65px - 60px );background: #dedede;">
              <div class="ovic-wrap-table-rps__inner">
                <p-table styleClass="p-datatable-gridlines" [value]="listData"
                         [rowHover]="true"
                         [rows]="rows" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]"
                         [loading]="isLoading">
                  <ng-template pTemplate="header" class="d-bock">
                    <tr>
                      <th class="ovic-w-40px text-center ">STT</th>
                      <th class="ovic-w-40px text-center ">ID</th>
                      <th class="ovic-w-100px text-center ">Số báo danh</th>
                      <th class="ovic-w-180px text-center">Họ và tên</th>
                      <th class="ovic-w-120px text-center">Ngày sinh</th>
                      <th class="ovic-w-80px text-center">Giới tính</th>
                      <th class="ovic-w-120px text-center">CMND/CCCD</th>
                      <th class="text-center">Email</th>
                      <th class="text-center">Số điện thoại</th>
                      <th class="ovic-w-130px text-center">Ca thi</th>
                      <th class="ovic-w-130px text-center">Phòng thi</th>
                      <th class="ovic-w-130px text-center">Môn thi</th>
                      <th class="ovic-w-100px text-center">Điểm</th>
                    </tr>
                  </ng-template>

                  <ng-template pTemplate="body" let-item>
                    <tr>
                      <td class="text-center">{{ item['__index_table'] }}</td>
                      <td class="text-center">{{ item.thisinh_id }}</td>
                      <td class="text-center">{{ item.sobd }}</td>
                      <td class="text-center">{{ item.hoten }}</td>
                      <td class="text-center">{{ item.ngaysinh }}</td>
                      <td class="text-center">{{ item.gioitinh }}</td>
                      <td class="text-center">{{ item.cccd_so }}</td>
                      <td class="text-center">{{ item.email }}</td>
                      <td class="text-center">{{ item.dienthoai }}</td>
                      <td class="text-center">{{ item.cathi }}</td>
                      <td class="text-center">{{ item.phongthi }}</td>
                      <td class="text-center">{{ item.monthi }}</td>
                      <td class="text-center">{{ item.diem }}</td>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="emptymessage">
                    <tr>
                      <td colspan="14">
                        Không có dữ liệu thí sinh!
                      </td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
            </div>
            <p-paginator class="duthi_panigator" [showCurrentPageReport]="true" [rows]="rows"
                         [totalRecords]="recordsTotal" [pageLinkSize]="5"
                         (onPageChange)="paginate($event)"></p-paginator>
          </div>
        </div>

      </div>
    </ng-container>
    <ng-container *ngSwitchCase="1">
      <div class="w-100" style="height:calc(100% - 60px)">
        <div class="row h-100">
          <div class="col-12 ovic-ui-table site-thpt" style="height:calc(100%)"
               [class.ovic-is-loading]="isLoading">
            <div class="p-datatable-header" style="height:65px; border-bottom:1px solid #CCC;">
              <h3 class="tbl-title ">Danh sách kết quả </h3>
              <div class="search-block ui-table-globalfilter-container ">
                <div>
                  <button pRipple pButton class="mx-2"
                          [ngClass]="ketquaChange === 'have' ?'p-button-primary' : 'ovic-button-none-selected'"
                          label="Kết quả hợp lệ " (click)="btnKetquaChange('have')"></button>
                  <button pRipple pButton class="mx-2"
                          [ngClass]="ketquaChange === 'nothave'?'p-button-primary' : 'ovic-button-none-selected'"
                          label="Kết quả không hợp lệ" (click)="btnKetquaChange('nothave')"></button>
                </div>
              </div>
            </div>
            <div class="ovic-wrap-table-rps ovic-scroll-style overflow-hidden overflow-y-auto"
                 style="height:calc(100% - 65px - 60px );background: #dedede;">
              <div class="ovic-wrap-table-rps__inner">
                <p-table styleClass="p-datatable-gridlines" [value]="ketquaImportView"
                         [rowHover]="true"
                         [rows]="rows" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]"
                         [loading]="isLoading">
                  <ng-template pTemplate="header" class="d-bock">
                    <tr>

                      <th class="ovic-w-40px text-center ">ID</th>
                      <th class="ovic-w-100px text-center ">Số báo danh</th>
                      <th class="ovic-w-180px text-center">Họ và tên</th>
                      <th class="ovic-w-120px text-center">Ngày sinh</th>
                      <th class="ovic-w-80px text-center">Giới tính</th>
                      <th class="ovic-w-120px text-center">CMND/CCCD</th>
                      <th class="text-center">Email</th>
                      <th class="text-center">Số điện thoại</th>
                      <th class="ovic-w-130px text-center">Ca thi</th>
                      <th class="ovic-w-130px text-center">Phòng thi</th>
                      <th class="ovic-w-130px text-center">Môn thi</th>
                      <th class="ovic-w-100px text-center">Điểm</th>
                    </tr>
                  </ng-template>

                  <ng-template pTemplate="body" let-item let-i="rowIndex">
                    <tr>
                      <td class="text-center">{{ item.thisinh_id }}</td>
                      <td class="text-center">{{ item.sobd }}</td>
                      <td class="text-center">{{ item.hoten }}</td>
                      <td class="text-center">{{ item.ngaysinh }}</td>
                      <td class="text-center">{{ item.gioitinh }}</td>
                      <td class="text-center">{{ item.cccd_so }}</td>
                      <td class="text-center">{{ item.email }}</td>
                      <td class="text-center">{{ item.dienthoai }}</td>
                      <td class="text-center">{{ item.cathi }}</td>
                      <td class="text-center">{{ item.phongthi }}</td>
                      <td class="text-center">{{ item.monthi }}</td>
                      <td class="text-center">{{ item.diem }}</td>

                    </tr>
                  </ng-template>
                  <ng-template pTemplate="emptymessage">
                    <tr>
                      <td colspan="12">
                        Không có dữ liệu thí sinh!
                      </td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
            </div>
            <p-paginator class="duthi_panigator" [showCurrentPageReport]="true"
                         [totalRecords]="recordsTotal" [pageLinkSize]="5"
                         (onPageChange)="paginate($event)"></p-paginator>
          </div>
        </div>
      </div>
    </ng-container>
  </ng-container>
</div>

